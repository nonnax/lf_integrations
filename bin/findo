#!/usr/bin/sh
set -e
set -u
# selected=$(rg  --max-depth 2 --vimgrep "$1" | awk -F: '{print $1 ":" $2}'  | fzf --preview 'preview.sh {}' --preview-window='50%')
if [ ! "$#" -gt 0 ]; then
  echo "Need a string to search for!";
  exit 1;
fi

selected="$(rg --ignore-case --vimgrep --sort path  --hidden --max-depth=2 "$1" | fzf --ansi  --preview 'preview {}' --preview-window='50%')"

if [ -z "$selected" ]; then
	echo 'no file selected'
	exit 0
else
	$EDITOR "$selected" 
	printf "$selected" | awk -F: '{ print $1 }' > /tmp/.findo
fi
